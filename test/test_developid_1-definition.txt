defmod test_developid_1 UnitTest dummyDuino (
 { 
    my $local_ProtocolListSIGNALduino = SIGNALduino_getProtocolList();
	isnt (exists($local_ProtocolListSIGNALduino->{'9999'}),1,"Check if testprotocol already is defined");
	
	$local_ProtocolListSIGNALduino->{'9999'} =
	{
			name			=> 'Unittest dummy protocol',
			comment         => 'unittest protocol',
			id				=> '9999',
	};
	$local_ProtocolListSIGNALduino->{'9998'} =
	{
			name			=> 'Unittest dummy protocol',
			comment         => 'unittest protocol',
			id				=> '9998',
	};

	my $msg;
	my $regex=$local_ProtocolListSIGNALduino->{'9999'}{id};
	my $regex_matched=0;
	
	my $mock = Mock::Sub->new;
    my $Log3= $mock->mock("SIGNALduino_Log3");
		$Log3->side_effect( sub { 
		if (!$regex_matched && $_[2] =~ /skipped/) 
		{
			if ($_[2] =~ $regex) 
			{
				$regex_matched=1;
			} 
		}
		Log3 $_[0], $_[1] ,$_[2];
	} 
	);
	my $subTestName='SIGNALduino_IdList developid "m" skip scenarios';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";
		$local_ProtocolListSIGNALduino->{'9999'}{developId}="m";
		plan tests => 3;
		$regex_matched=0;
		
		$msg="attr whitelist=10, development=\"\"" ;
		SIGNALduino_IdList("x:$target","10","","");
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;
		
		$msg="attr whitelist=10, development=1" ;
		SIGNALduino_IdList("x:$target","10","",1);
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;

		$msg="attr blacklist=9999, development=0" ;
		SIGNALduino_IdList("x:$target","",9999,0);
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";

	};
	
	$subTestName='SIGNALduino_IdList developid "y" skip scenarios';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";
		$local_ProtocolListSIGNALduino->{'9999'}{developId}="y";
		plan tests => 4;
		$regex_matched=0;
		
		$msg="attr whitelist=\"\", development=\"\"" ;
		SIGNALduino_IdList("x:$target","","","");
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;
		
		$msg="attr whitelist=\"\", development=0" ;
		SIGNALduino_IdList("x:$target","","","");
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"y75\"" ;
		SIGNALduino_IdList("x:$target","","","y75");
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;

		
		$msg="attr whitelist=\"\", development=\"m9999\"" ;
		SIGNALduino_IdList("x:$target","","","m9999");  
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";
	};

	$subTestName='SIGNALduino_IdList developid "p" skip scenarios';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";

		$local_ProtocolListSIGNALduino->{'9999'}{developId}="p";
		plan tests => 4;
		$msg="attr whitelist=\"\", development=\"\"" ;
		SIGNALduino_IdList("x:$target","","","");
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;
	
		$msg="attr whitelist=\"\", development=0" ;
		SIGNALduino_IdList("x:$target","","","");
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"p75\"" ;
		SIGNALduino_IdList("x:$target","","","p75"); 
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"m9999\"" ;
		SIGNALduino_IdList("x:$target","","","m9999"); 
		ok($regex_matched,$msg) or diag("check log entrys for skipped with id 9999, they where not found");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";

	};
	
	
	$subTestName='SIGNALduino_IdList developid "m" not skipped scenarios';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";
		$local_ProtocolListSIGNALduino->{'9999'}{developId}="m";
		plan tests => 2;
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"m9999\"" ;
		SIGNALduino_IdList("x:$target","","","m9999");  
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id 9999, they should not be there");
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"75 m9999 u73\"" ;
		SIGNALduino_IdList("x:$target","","","m75 m9999 u73"); 
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id 9999, they should not be there");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";
	};
	
	$subTestName='SIGNALduino_IdList developid "y" not skipped scenarios';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";
		$local_ProtocolListSIGNALduino->{'9999'}{developId}="y";
		plan tests => 2;
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"y9999\"" ;
		SIGNALduino_IdList("x:$target","","","y9999");  
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id 9999, they should not be there");
		$regex_matched=0;

		$msg="attr whitelist=\"\", development=\"m75 y9999 u73\"" ;
		SIGNALduino_IdList("x:$target","","","m75 y9999 u73"); 
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id 9999, they should not be there");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";

	};
	
	$subTestName='SIGNALduino_IdList developid "p" not skipped scenarios';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";
		$local_ProtocolListSIGNALduino->{'9999'}{developId}="p";
		plan tests => 2;
		$regex_matched=0;

		$msg="attr whitelist=\"9999\", development=\"\"" ;
		SIGNALduino_IdList("x:$target","9999","","");  
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id 9999, they should not be there");
		$regex_matched=0;

		$msg="attr whitelist=\"9999\", development=\"m75 p9999 u73\"" ;
		SIGNALduino_IdList("x:$target","9999","","m75 u73"); 
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id 9999, they should not be there");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";

	};
	
	$subTestName='SIGNALduino_IdList multiple development statements';
	subtest $subTestName => sub {
		Log3 $name, 3 ,$subTestName." |-->";

		$local_ProtocolListSIGNALduino->{'9999'}{developId}="y";
		$local_ProtocolListSIGNALduino->{'9998'}{developId}="m";

		plan tests => 2;
		$regex_matched=0;
		
		$msg="attr whitelist=\"\", development=\"y m9998\"" ;
		SIGNALduino_IdList("x:$target","","","y m9999");  
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id $regex, this should not be skipped");
		$regex_matched=0;
		
		my $regex=$local_ProtocolListSIGNALduino->{'9998'}{id};
		isnt($regex_matched,1,$msg) or diag("check log entrys for skipped with id $regex, this should not be skipped");
		$regex_matched=0;
		Log3 $name, 3 ,$subTestName." <--|";

	
	}
		
	};
	
	}
);

